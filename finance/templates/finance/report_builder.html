<!-- finance/templates/finance/report_builder.html -->
{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h1>üìä –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤</h1>

    <div class="row">
        <!-- –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç—á–µ—Ç—ã -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5>üöÄ –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç—á–µ—Ç—ã</h5>
                </div>
                <div class="card-body">
                    <p>–°–∫–∞—á–∞–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥:</p>

                    <div class="d-grid gap-2">
                        <a href="{% url 'finance:quick_reports' %}?type=day&format=pdf"
                           class="btn btn-outline-primary">
                            üìÖ –û—Ç—á–µ—Ç –∑–∞ –¥–µ–Ω—å (PDF)
                        </a>
                        <a href="{% url 'finance:quick_reports' %}?type=day&format=excel"
                           class="btn btn-outline-success">
                            üìÖ –û—Ç—á–µ—Ç –∑–∞ –¥–µ–Ω—å (Excel)
                        </a>

                        <a href="{% url 'finance:quick_reports' %}?type=week&format=pdf"
                           class="btn btn-outline-primary">
                            üìä –û—Ç—á–µ—Ç –∑–∞ –Ω–µ–¥–µ–ª—é (PDF)
                        </a>
                        <a href="{% url 'finance:quick_reports' %}?type=week&format=excel"
                           class="btn btn-outline-success">
                            üìä –û—Ç—á–µ—Ç –∑–∞ –Ω–µ–¥–µ–ª—é (Excel)
                        </a>

                        <a href="{% url 'finance:quick_reports' %}?type=month&format=pdf"
                           class="btn btn-outline-primary">
                            üìà –û—Ç—á–µ—Ç –∑–∞ –º–µ—Å—è—Ü (PDF)
                        </a>
                        <a href="{% url 'finance:quick_reports' %}?type=month&format=excel"
                           class="btn btn-outline-success">
                            üìà –û—Ç—á–µ—Ç –∑–∞ –º–µ—Å—è—Ü (Excel)
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ -->
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h5>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç—á–µ—Ç</h5>
                </div>
                <div class="card-body">
                    <form id="report-form" action="{% url 'finance:create_report' %}" method="post">
                        {% csrf_token %}

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞</label>
                                    <input type="text" name="name" class="form-control"
                                           value="–ú–æ–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">–§–æ—Ä–º–∞—Ç</label>
                                    <select name="format" class="form-control">
                                        <option value="pdf">PDF –¥–æ–∫—É–º–µ–Ω—Ç</option>
                                        <option value="excel">Excel —Ç–∞–±–ª–∏—Ü–∞</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">–ü–µ—Ä–∏–æ–¥ –æ—Ç—á–µ—Ç–∞</label>
                            <select name="period_type" class="form-control" id="period-type">
                                <option value="day">–ó–∞ —Å–µ–≥–æ–¥–Ω—è</option>
                                <option value="week" selected>–ó–∞ —Ç–µ–∫—É—â—É—é –Ω–µ–¥–µ–ª—é</option>
                                <option value="month">–ó–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</option>
                                <option value="year">–ó–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥</option>
                                <option value="custom">–ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥</option>
                            </select>
                        </div>

                        <div class="mb-3" id="custom-dates" style="display: none;">
                            <label class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—ã</label>
                            <div class="row">
                                <div class="col-md-6">
                                    <input type="date" name="start_date" class="form-control">
                                </div>
                                <div class="col-md-6">
                                    <input type="date" name="end_date" class="form-control">
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary">
                            üéØ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç
                        </button>
                    </form>
                </div>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –æ—Ç—á–µ—Ç–∞—Ö -->
            <div class="card mt-4">
                <div class="card-header">
                    <h5>‚ÑπÔ∏è –û –æ—Ç—á–µ—Ç–∞—Ö</h5>
                </div>
                <div class="card-body">
                    <h6>PDF –æ—Ç—á–µ—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç:</h6>
                    <ul>
                        <li>–°–≤–æ–¥–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ—Ö–æ–¥–∞—Ö –∏ —Ä–∞—Å—Ö–æ–¥–∞—Ö</li>
                        <li>–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</li>
                        <li>–î–µ—Ç–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π</li>
                        <li>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</li>
                    </ul>

                    <h6>Excel –æ—Ç—á–µ—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç:</h6>
                    <ul>
                        <li>–î–µ—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ª–∏—Å—Ç–µ</li>
                        <li>–°–≤–æ–¥–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</li>
                        <li>–ê–Ω–∞–ª–∏–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Å –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏</li>
                        <li>–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const periodType = document.getElementById('period-type');
    const customDates = document.getElementById('custom-dates');

    periodType.addEventListener('change', function() {
        customDates.style.display = this.value === 'custom' ? 'block' : 'none';
    });

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
    const today = new Date().toISOString().split('T')[0];
    const oneMonthAgo = new Date();
    oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
    const oneMonthAgoStr = oneMonthAgo.toISOString().split('T')[0];

    document.querySelector('input[name="start_date"]').value = oneMonthAgoStr;
    document.querySelector('input[name="end_date"]').value = today;
});
</script>
{% endblock %}